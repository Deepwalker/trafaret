version: 2

jobs:
  # using tox
  toxify:
      docker:
        - image: circleci/python:3.8.5
      environment:
        TOXENV: py37,py38
      steps: &toxsteps
        - checkout
        - restore_cache:
           keys:
             - pip_cache_{{ checksum "setup.py" }}
        - run:
            name: Install utils
            command: |
              sudo pip install tox wheel
        - run:
            command: tox
        - save_cache:
            key: pip_cache_{{ checksum "setup.py" }}
            paths:
              - "~/project/.tox"

workflows:
  version: 2

  build:
    jobs:
      - toxify
